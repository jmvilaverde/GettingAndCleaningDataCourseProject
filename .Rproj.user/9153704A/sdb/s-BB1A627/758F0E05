{
    "contents" : "##function run_analysis\n##ASIGNMENT:\n##You should create one R script called run_analysis.R that does the following. \n##1.Merges the training and the test sets to create one data set.\n##2.Extracts only the measurements on the mean and standard deviation for each measurement. \n##3.Uses descriptive activity names to name the activities in the data set\n##4.Appropriately labels the data set with descriptive variable names. \n##5.From the data set in step 4, creates a second, independent tidy data set with the average \n##of each variable for each activity and each subject.\n\n##Load library dplyr\nlibrary(dplyr)\n\n\n##Main function, calls to \nrun_analysis <- function(){\n        \n        ##Adquire Data\n        adquireFile(\"https://d396qusza40orc.cloudfront.net/getdata%2Fprojectfiles%2FUCI%20HAR%20Dataset.zip\", \"./UCI HAR Dataset\")\n        \n        ##Extract data from the files and merge training and test sets in one set\n        dataComplete <- fileToData(\"./UCI HAR Dataset\")\n        \n        #Obtains Data set of averages per value grouped by Subject and Activity\n        dataAverage <<- getDataSetAverage(dataComplete)\n        \n        #save set to a file\n        saveDataToFile(dataAverage)\n}\n\nadquireFile <- function(fileUrl = \"https://d396qusza40orc.cloudfront.net/getdata%2Fprojectfiles%2FUCI%20HAR%20Dataset.zip\",\n                        unzipPath = \"./UCI HAR Dataset\"){\n        \n        fileZip <- \"./temp.zip\"\n        \n        if (!file.exists(unzipPath)){\n                if (!file.exists(fileZip)){\n                        download.file(fileUrl, fileZip)\n                }\n                unzip(fileZip)\n        }\n        \n        ##Delete directory after process data\n        #unlink(dirPath, recursive = TRUE)\n}\n\nfileToData <- function(path = \"./UCI HAR Dataset\"){\n        \n        #Get labels for X_???.txt and activity list\n        getLabels(path)\n        \n        testPath <- paste(path,\"test/\", sep = \"/\")\n        extTest <- \"_test.txt\"\n        dataTest <- getDataSet(testPath, extTest)\n        \n        trainPath <- paste(path,\"train/\", sep = \"/\")\n        extTrain <- \"_train.txt\"\n        dataTrain <- getDataSet(trainPath, extTrain)\n        \n        #merge Test and Train set in only one\n        dataComplete <<- rbind(dataTest, dataTrain)\n        dataComplete\n        \n}\n\n\ngetLabels <- function(path = \"./UCI HAR Dataset\"){\n        features <<- read.table(paste(path, \"features.txt\", sep = \"/\"))\n        features <<- rename(features, Id = V1, Feature_Label = V2)\n        activity_labels <<- read.table(paste(path, \"activity_labels.txt\", sep = \"/\"))\n        activity_labels <<- rename(activity_labels, Id = V1, Activity_Label = V2)\n        \n}\n\n#Obtains data from files, sets the column names, filter columns that only contains \"mean\" and \"std\",\n#merges activity Id with his activity name\n#merges all three datasets = X + y + subject\n#return the complete data sets\n\ngetDataSet <- function(path, ext){\n        dataX <- read.table(paste(path,\"X\", ext, sep = \"\"), col.names = features$Feature_Label)\n        dataY <- read.table(paste(path,\"y\", ext, sep = \"\"), col.names = c(\"Id_Activity\"))\n        dataSub <- read.table(paste(path,\"subject\", ext, sep = \"\"), col.names = \"Subject\")\n        \n        #Obtain only data with \"mean\" or \"str\" column label for dataX\n        #It's possible to quit \"meanFreq\", but I consider it as a \"mean\"\n        dataXOptimized <- dataX[,grepl(pattern=\"mean\", x = names(dataX))|grepl(pattern=\"std\", x = names(dataX))]\n        \n        #Complete data from Y with the name for activities\n        #Inner join between dataY and activity_labels\n        dataYCompleted <<- merge(dataY, activity_labels, by.x=\"Id_Activity\", by.y=\"Id\")\n        \n        data <- cbind(dataXOptimized, dataYCompleted, dataSub)\n        \n        data\n}\n\ngetDataSetAverage <- function(dataSet){\n        ##TODO create averagete over grouped_by values\n        data <- aggregate(dataComplete[,1:79], list(dataComplete$Subject, dataComplete$Activity_Label), mean)\n        data <- rename(data, Subject = Group.1, Activity = Group.2)\n        data <- arrange(data, Subject, Activity)\n        data\n}\n\nsaveDataToFile <- function(dataToSave){\n        write.table(dataToSave, file=\"tidyData.txt\", row.name=FALSE)\n}",
    "created" : 1432056356241.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "2886832486",
    "id" : "758F0E05",
    "lastKnownWriteTime" : 1432143495,
    "path" : "D:/Privado/repos/3.GettingAndCleaningData/CourseProject/run_analysis.R",
    "project_path" : "run_analysis.R",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "source_on_save" : false,
    "type" : "r_source"
}